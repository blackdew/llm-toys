<div class="container">
    <div class="progress">
        문장 진행률: <span id="progress">{current_index_display}</span> / {total_sentences}
    </div>
    <div class="text-display" id="target-text">
        {words_html}
    </div>
    <input type="text" id="typing-input" placeholder="Type here...">
</div>

<style>
    .container {{
        width: 100%;
        max-width: 800px;
        margin: 20px auto;
    }}
    .progress {{
        font-size: 16px;
        color: #666;
        margin-bottom: 10px;
    }}
    .text-display {{
        font-size: 24px;
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 5px;
        margin: 20px 0;
    }}
    #typing-input {{
        width: 100%;
        font-size: 18px;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ddd;
        border-radius: 5px;
    }}
    .word {{
        display: inline-block;
        margin-right: 8px;
        transition: color 0.2s;
    }}
    .correct {{
        color: #28a745;
    }}
    .incorrect {{
        color: #dc3545;
    }}
</style>

<script>
    const input = document.getElementById('typing-input');
    const words = document.querySelectorAll('.word');
    let allWordsCorrect = false;

    input.addEventListener('input', function(e) {{
        const inputText = e.target.value;
        const inputWords = inputText.trim().split(' ');
        
        // 모든 단어의 스타일 초기화
        words.forEach(word => {{
            word.classList.remove('correct', 'incorrect');
        }});

        // 입력된 단어들 검사
        allWordsCorrect = true;
        inputWords.forEach((word, i) => {{
            if (i < words.length) {{
                const targetWord = words[i].textContent;
                if (word === targetWord) {{
                    words[i].classList.add('correct');
                }} else if (word) {{
                    words[i].classList.add('incorrect');
                    allWordsCorrect = false;
                }}
            }}
        }});
        
        // 모든 단어가 입력되었고 모두 정확한지 확인
        if (inputWords.length === words.length && allWordsCorrect) {{
            allWordsCorrect = true;
        }} else {{
            allWordsCorrect = false;
        }}
    }});

    input.addEventListener('keypress', function(e) {{
        if (e.key === 'Enter' && allWordsCorrect) {{
            // 모든 단어가 정확하게 입력되었을 때만 다음 문장으로 넘어감
            input.value = '';  // 입력창 초기화
            window.location.href = '{next_sentence_url}';  // URL 변경으로 다음 문장 요청
        }}
    }});
</script> 